%TC: macro \marginfootnote [other]
%TC: envir SCfigure [] other
%TC: macrocount beginSCfigure [figure]
\documentclass[12pt]{report}
\usepackage{preamble}
\setcounter{chapter}{1}
\graphicspath{{../img/}}

\begin{document}
\chapter[A primer on integral geometry. Or ``How big is that thing?'']{A primer on integral geometry\\ {\large Or ``How big is that thing?''}}

Advantage of geometric approach is in the intuition gained.
With that in mind the aim of this section is to provide a primer on useful geometric concepts and relations.
Particularly regarding integral geometry, which is generally unfamiliar to people from physics background.
Emphasis hear is on concepts and intuition rather than rigour.

\section{Introduction}

The mathematical formalism which provides elegant and unified description of sizes, underlying the morphological approach taken in the thesis.
Ideas from this branch of mathematics were crucial to the development of fundamental measure theory, so it makes sense to place this before the section on liquid state theory.
Integral geometry is generally unfamiliar to people with a background in physics, so I will attempt to describe this area with additional care.

Make connections with statistical physics frequently.

Possible additions:
\begin{itemize}
\item Measure theory?
\item Partially ordered sets?
\end{itemize}

\subsection{Motivation}

Want to describe how `big' an object is.
First we define our objects: sets in Euclidean space.
We will see that the only reasonable notion of size is a \emph{continuous} rigid-motion invariant valuation.

\subsection{Selected facts from differential geometry}

I will assume some familiarity with differential geometry.
I will review some results concerning curvature measures.

\subsubsection{Curvature measures}

Curvature tensors
\begin{equation}
  \kappa_{\alpha\beta} = \frac{\partial \vec{g}_\alpha}{\partial x_\beta}
\end{equation}
Note this is a symmetric tensor i.e.\ $\kappa_{\alpha\beta} = \kappa_{\beta\alpha}$.

\subsubsection{Worked example: 2d hinges}

This example is to illustrate how the curvature measures can be integrated over general bodies making them quite generic.
Even though the curvature measure is not locally defined at the cusp, the resulting integrated measure is still well defined.

Consider some path $L$ that parameterises on $\xi \in [0, \Xi]$.
Some covariant vector (not necessarily normalised)
\begin{equation*}
  \vec{g} = \frac{\partial \vec{r}}{\partial \xi}.
\end{equation*}
We have the normal vector $\vec{n} = \vec{g} \times \vec{e}_z = \vec{r}' \times \vec{e}_z$ giving curvature $\kappa = \vec{r}' \cdot \vec{n}' = \vec{r}' \cdot (\vec{r}'' \times \vec{e}_z)$.
Here we use $\vec{e}_z$ to mean the unit vector in the $z$ direction.
The integrated curvature along the path is thus
\begin{equation*}
  C_L = \int_L \vec{r}' \cdot ( \vec{r}'' \times \vec{e}_z ) \, d|\vec{r}|.
\end{equation*}
The nonzero part of the integrand occurs where $\vec{r}' \perp \vec{r}''$ i.e.\ the circular part of motion.
We can thus consider cases where the path is locally circular without loss of generality, thus $\xi \equiv \theta \in [\theta_0, \theta_1]$ and the curvature $\kappa = \tfrac{1}{r}$.
Motion orthogonal the angular changes does not contribute to the integrated curvature, so the integral reduces to
\begin{equation*}
  C_L = \int_L \frac{1}{r} \, r d\theta
  = \int_L \, d\theta
  = \theta_1 - \theta_0 \equiv \Delta\theta
\end{equation*}
where $\Delta\theta = \theta_1 - \theta_0$%
\marginfootnote{NB: We have not constrained the the allowable values of $\theta$, so if $L$ is a closed path we have $\Delta\theta = 2 n \pi$ where $n \in \mathbb{Z}$ is the winding number for the path, i.e. the number of complete anticlockwise turns.
  A value $n \ne 1$ indicates that the path self-intersects.}.
Note that as the dependence on $r$ dropped out in the second line, this even works on hinges.
Graphical example.

\subsection{Generalised functions acting on sets}
\subsubsection{Set arithmetic}

Scalar multiplication or \emph{dilate}:
\begin{equation}
  \epsilon A = \{\epsilon a : a \in A\}
\end{equation}
\emph{Minkowski addition}:
\begin{equation}
  A + B := \{ a + b : a \in A \textrm{ and } b \in B \}
\end{equation}
\begin{SCfigure}[H]
  \missingfigure[figwidth=0.333\linewidth]{}%
  \missingfigure[figwidth=0.333\linewidth]{}%
  \missingfigure[figwidth=0.333\linewidth]{}
  \caption{Examples of Minkowski addition with ball:
    ball $\to$ ball,
    line $\to$ capsule/spherocylinder (common in nature: bacterium?),
    circle $\to$ torus.
  }
\end{SCfigure}
\emph{Minkowski difference}:
\begin{equation}
  A - B := \{ c : c + B \subseteq A \}
\end{equation}
Note that these operations are not the inverses of each other as in the the case of arithmetic, i.e.\ in general
\begin{equation*}
  A - B \ne A + (-B).
\end{equation*}
Instead, set addition and subtraction operations are related through
\begin{equation*}
  A - B = (A^C + (-B))^C.
\end{equation*}

\begin{SCfigure}[H]
  \missingfigure[figwidth=0.5\linewidth]{$A + B$ growth}%
  \missingfigure[figwidth=0.5\linewidth]{$A + B - B$ erosion}
  \caption{Minkowski addition and difference not the inverse of each other.}
\end{SCfigure}

\subsubsection{Distances between sets}
The Hausdorff metric.
\subsubsection{Valuations on sets}
Additivity criterion and its significance

Examples:
\begin{itemize}
\item Additivity of the entropy.
\item Connection between sets and events: probabilistic interpretation of measures.
\end{itemize}

\subsubsection{Which sets do we consider}

We consider Polyconvex sets (convex ring).

Avoid pathological sets: Banach-Tarski paradox allows one to break a sphere apart and recompose it as two identical spheres.
We want a well-defined volume, so need to avoid sets which allow this.
\marginfootnote{Have to be formed by countable union of convex objects.
Covers most physically realistic geometries.}

\subsubsection{Euler characteristic}

Aim of this section is to provide intuition over Euler characteristic.

\begin{tcolorbox}[title=A note on nomenclature]
  Difference between sphere and ball.
  \begin{equation*}
    S^{d-1} = \partial B^d
  \end{equation*}
\end{tcolorbox}

Should explain intrinsic volumes earlier perhaps.
Euler characteristic of a boundary depends on dimension:
\begin{align}
  \mu_0(K^d) &= 1 \\
  \mu_0(\partial K^d) &= 1 + (-1)^d
\end{align}
Disjoint union: sum them (by inclusion-exclusion principle).

Repeat arguments in figures and you obtain the general rule that dividing an $n$-sphere gives two $n-1$-dimensional convex objects and a $n-1$ sphere dividor.
This gives us the rule for the Euler characteristic.
Euler characteristic describes the topology.

\begin{itemize}
\item Multiple disjoint convex objects: increase
\item Holes lower Euler characteristic
\item Cavities increase
\end{itemize}

For $d=3$ we have the important Gauss-Bonnet theorem.

\begin{SCfigure}[H]
  \missingfigure[figwidth=\linewidth]{boundary points in 1d (rod)}
  \caption{Only convex object in 1d is a rod.}
\end{SCfigure}

\begin{SCfigure}[H]
  \missingfigure[figwidth=0.5\linewidth]{$\partial B$}%
  \missingfigure[figwidth=0.5\linewidth]{$\partial B$}
  \caption{Effect of holes: divide 2d circle in two (2 rods + 2 points).}
\end{SCfigure}

\begin{SCfigure}[H]
  \missingfigure[figwidth=0.5\linewidth]{$\partial B$}%
  \missingfigure[figwidth=0.5\linewidth]{$\partial B$}
  \caption{Effect of cavities: divide 3d sphere in two (2 disks + circle).}
\end{SCfigure}

\subsection{Important theorems for continuous invariant valuations}

\subsubsection{Invariant measures}

\begin{itemize}
\item Introduce intrinsic volumes $\{\mu_k\}_{k=0}^d$
\item Minkowski functionals as alternative $\{W_k\}_{k=0}^d$
\item Examples: intrinsic volumes of unit ball $B_d$ and cube ($C_d$).
\item Compact convex set $K \in \mathcal{K}$ notation.
\item Notation for convex ring/polyconvex sets
\item Difference between $\mu_0(K)$ and $\mu_0(\partial K)$.
\item Figure for curvatures and cusps: how you can define the intrinsic volumes but not the local curvature. Worked example.
\end{itemize}

The volume of the unit ball in $d$-dimensions is
\begin{equation}
  \omega_d := \mu_d(B_d) = \frac{\pi^{d/2}}{\Gamma(\frac{d}{2} + 1)}.
\end{equation}
Intrinsic volumes of the unit ball:
\begin{equation}\label{eq:intrinsic-volume-ball}
  \mu_k (B_d) = {d \choose k} \frac{\omega_d}{\omega_{d-k}}
\end{equation}
Unit cube:
\begin{equation}
  \mu_k (C_d) = {d \choose k}
\end{equation}
Alternative normalisation sometimes used: $\{W_k\}_{k=0}^d$ are the Minkowski functionals, or \emph{quermassintegrals}.
\begin{equation}
  W_k(K) = {d \choose k}^{-1} \omega_k \, \mu_{d-k}(K)
\end{equation}
This choice of normalisation sets $W_k(B_d) = \omega_k$ for all $k$.

\begin{center}
\begin{tabular}{cccccc}
  \toprule
  $k$ & $\omega_k$ & $\mu_k(B_2)$ & $W_k(B_2)$ & $\mu_k(B_3)$ & $W_k(B_3)$ \\
  \midrule
  0 & 1 & 1 & $\pi$ & 1 & $\frac{4\pi}{3}$ \\
  1 & 2 & $\pi$ & $\pi$ & 4 & $\frac{4\pi}{3}$ \\
  2 & $\pi$ & $\pi$ & $\pi$ & $2\pi$ & $\frac{4\pi}{3}$ \\
  3 & $\frac{4\pi}{3}$ &&& $\frac{4\pi}{3}$ & $\frac{4\pi}{3}$ \\
  \bottomrule
\end{tabular}
\end{center}

\begin{theorem}{Hadwiger's characterisation theorem}
  Together the functionals $\{\mu_k\}_{k=0}^d$ form a basis for the vector space of all continuous rigid-motion invariant valuations on polyconvex sets in $\mathbb{R}^d$.
\end{theorem}

I.e. a continuous rigid-motion invariant valuation can be written
\begin{equation}
  \mu(A) = \sum_{i=0}^d c_i \mu_i(A)
\end{equation}
where $c_i$ are some coefficients independent of $A$.

\begin{theorem}{Steiner's formula for parallel volumes}
  For a compact, convex body $K \in \mathcal{K}$ the parallel volume is expressable as:
  \begin{equation}
    \mu_d(K + \epsilon B_d) =
    \sum_{i=0}^d \mu_i(K) \omega_{d-i} \epsilon^{d-i}
  \end{equation}
\end{theorem}

%% Other normalisation:
%% \begin{equation}
%%   \mu_d(K + \epsilon B_d) =
%%   \sum_{i=0}^d W_i^{(d)}(K) {d \choose i} \epsilon^i
%% \end{equation}
%% where $K \in \mathcal{K}$.

\begin{SCtable}
  \begin{minipage}[b]{\linewidth}
  \centering
  \begin{tabular}{ccc}
    \toprule
    \multicolumn{2}{c}{Geometric property} \\
    \cmidrule(r){1-2}
    Name & Symbol & Functional \\
    \midrule
    \multicolumn{3}{c}{$d = 1$} \\
    \midrule
    Euler characteristic & $\chi$ & $\mu_0$ \\
    Length & $L$ & $\mu_1$ \\
    \midrule
    \multicolumn{3}{c}{$d = 2$} \\
    \midrule
    Euler characteristic & $\chi$ & $\mu_0$ \\
    Perimeter & $L$ & $2 \mu_1$ \\
    Area & $A$ & $\mu_2$ \\
    \midrule
    \multicolumn{3}{c}{$d = 3$} \\
    \midrule
    Euler characteristic & $\chi$ & $\mu_0$ \\
    Integrated Gaussian curvature & $X$ & $4 \pi \mu_0$ \\
    Integrated mean curvature & $C$ & $\pi \mu_1$ \\
    Mean width & $b$ & $\frac{1}{2} \mu_1$ \\
    Surface area & $A$ & $2 \mu_2$ \\
    Volume & $V$ & $\mu_3$ \\
    \bottomrule
  \end{tabular}
  \end{minipage}
  \caption{The intrinsic volumes $\{\mu_k\}$ are evaluated on some $K \in \mathcal{K}$.
    The corresponding geometric interpretation of $\mu_k$ for $k < d$ typically involves integrations of the boundary $\partial K$, e.g. $C,X,A$ for $d=3$.
    However, the intrinsic volumes are more general (they can be calulated for shapes where curvatures not locally definable, e.g. at vertices).}
\end{SCtable}

\subsubsection{Principal kinematic formula}

We have the invariant measure on 1-dimensional linear subspaces of $\mathbb{R}^d$ (\emph{Grassmanians}) as
\begin{equation}
  [d] = \tau_d(\textrm{Gr}(d,1))
  = \frac{d \omega_d}{2 \omega_{d-1}}.
\end{equation}
Factorial defined as
\begin{equation}
  [k]! = \prod_{i=0}^k \, [i]
\end{equation}
Flag coefficients from binomial coefficients
\begin{equation}
  {d \brack k}
  := \frac{[n]!}{[k]! [n-k]!}
  = {d \choose k}
  \frac{\omega_d}{\omega_k \omega_{d-k}}
\end{equation}
Provides the generalisation of combinatorial results to continuous spaces\marginfootnote{For this reason Klain and Rota argue that integral geometry/geometric probability should be called \emph{continuous combinatorics} \cite{Klain1997}}.
Analagously to binomial coefficients, the flag coefficients obey
\begin{equation}\label{eq:flag-coefficients-symmetry}
  {d \brack k} = {d \brack d - k}.
\end{equation}
Note that we can rewrite \eqref{eq:intrinsic-volume-ball} using the flag coefficients as
\begin{equation}\label{eq:intrinsic-volume-ball-flag}
  \mu_k (B_d) = {d \choose k} \frac{\omega_d}{\omega_{d-k}}
  = {d \brack k} \omega_k
\end{equation}

\begin{center}
\begin{tabular}{cccccc}
  \toprule
  $k$ & $\omega_k$ & $[k]$ & $[k]!$ & ${2 \brack k}$ & ${3 \brack k}$ \\
  \midrule
  0 & 1 & 1 & 1 & 1 & 1 \\
  1 & 2 & 1 & 1 & $\frac{\pi}{2}$ & 2 \\
  2 & $\pi$ & $\frac{\pi}{2}$ & $\frac{\pi}{2}$ & 1 & 2 \\
  3 & $\frac{4\pi}{3}$ & 2 & $\pi$ & & 1 \\
  \bottomrule
\end{tabular}
\end{center}

\begin{theorem}{General kinematic formula}
  For $0 \le k \le d$:
  \begin{equation}
    \int_{\mathbb{E}_d} \mu_k (A \cap g B) \, dg =
    \sum_{i=0}^{d-k}
    {i + k \brack k} {d \brack i}^{-1}
    \mu_{i+k}(A) \mu_{d-i}(B)
  \end{equation}
  \begin{equation*}
    \int_{\mathbb{E}_d} \mu_k (A \cap g B) \, dg =
    \sum_{i=0}^{d-k}
    {i + k \brack k}
    {d \brack i + k}
    \kappa_{i+k}(A) \kappa_{d-i}(B)
  \end{equation*}
  In regular binomial:
  \begin{equation*}
    \int_{\mathbb{E}_d} \mu_k (A \cap g B) \, dg =
    \sum_{i=0}^{d-k}
    {i + k \choose k} {d \choose i}^{-1}
    \frac{\omega_{i+k} \omega_{d-i}}{\omega_k \omega_d}
    \mu_{i+k}(A) \mu_{d-i}(B)
  \end{equation*}
\end{theorem}

\begin{equation*}
  {n \choose k} {k \choose p}
  =
  \frac{n!}{k!(n-k)!}
  \frac{k!}{p!(k-p)!}
  =
  \frac{n!}{p!(k-p)!(n-k)!}
  =
  {n \choose p, k-p, n-k}
\end{equation*}
I.e. this is a trinomial coefficient.
So we have
\begin{equation*}
  {n \brack k} {k \brack p}
  =
  {n \choose k}
  {k \choose p}
  \frac{\omega_n}{\omega_k \omega_{n-k}}
  \frac{\omega_k}{\omega_p \omega_{k-p}}
  =
  {n \choose p, k-p, n-k}
  \frac{\omega_n}{\omega_p \omega_{k-p} \omega_{n-k}}
\end{equation*}

\section{Physical examples}

\subsection{Additivity and extensivity}

\subsection{Free volume calculations}

The free volume from Steiner's theorem.

Free volume theories: (free) energy based on size of an object.
\todo{Can I find a coherent definition of free volume theories?
Can I cook one up?
Need at least two examples to draw a trend.
Free volume theories in polymers are probably the best well known.
Free volume theory in glasses?}
We could argue that fundamentally these theories are based on measuring physical sizes.
Integral geometry offers a mathematically rigorous formalism for describing sizes, so presents a possible starting point for free volume theories.

\end{document}
